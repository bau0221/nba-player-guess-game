<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NBA 球員猜猜看</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      text-align: center; 
      padding: 50px; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.1);
      padding: 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }
    h1 {
      font-size: 2.5em;
      margin-bottom: 30px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .teams { 
      margin-bottom: 30px; 
      font-size: 1.3em; 
      background: rgba(255, 255, 255, 0.2);
      padding: 20px;
      border-radius: 10px;
      line-height: 1.6;
    }
    .input-container {
      position: relative;
      display: inline-block;
      margin-bottom: 20px;
    }
    input { 
      padding: 12px 15px; 
      font-size: 1.1em; 
      border: none;
      border-radius: 25px;
      width: 300px;
      outline: none;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    .autocomplete-list {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      max-height: 200px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
    }
    .autocomplete-item {
      padding: 12px 15px;
      color: #333;
      cursor: pointer;
      border-bottom: 1px solid #eee;
      text-align: left;
    }
    .autocomplete-item:hover, .autocomplete-item.selected {
      background: #f0f0f0;
    }
    .autocomplete-item:last-child {
      border-bottom: none;
    }
    button { 
      padding: 12px 20px; 
      font-size: 1.1em; 
      margin: 0 10px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      background: #ff6b6b;
      color: white;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    #nextBtn {
      background: #4ecdc4;
    }
    .result { 
      margin-top: 30px; 
      font-size: 1.3em; 
      padding: 20px;
      border-radius: 10px;
      min-height: 50px;
    }
    .correct {
      background: rgba(76, 175, 80, 0.3);
      border: 2px solid #4caf50;
    }
    .incorrect {
      background: rgba(244, 67, 54, 0.3);
      border: 2px solid #f44336;
    }
    .loading {
      font-size: 1.2em;
      color: #ffd700;
    }
    .stats {
      margin-top: 20px;
      font-size: 1.1em;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🏀 NBA 球員猜猜看</h1>
    <div class="loading" id="loading">正在載入NBA球員資料...</div>
    <div id="gameContent" style="display: none;">
      <div class="teams" id="teams"></div>
      <div class="input-container">
        <input type="text" id="guessInput" placeholder="輸入球員姓名...">
        <div class="autocomplete-list" id="autocompleteList"></div>
      </div>
      <div>
        <button id="submitBtn">🎯 猜一猜</button>
        <button id="nextBtn">➡️ 下一題</button>
      </div>
      <div class="result" id="result"></div>
      <div class="stats" id="stats">正確: 0 | 錯誤: 0 | 準確率: 0%</div>
    </div>
  </div>

  <script>
    let allPlayers = [];
    let currentPlayer = null;
    let correctCount = 0;
    let incorrectCount = 0;
    let selectedIndex = -1;

    // 團隊名稱映射（英文到中文）
    const teamTranslations = {
      'Atlanta Hawks': '亞特蘭大老鷹',
      'Boston Celtics': '波士頓塞爾提克',
      'Brooklyn Nets': '布魯克林籃網',
      'Charlotte Hornets': '夏洛特黃蜂',
      'Chicago Bulls': '芝加哥公牛',
      'Cleveland Cavaliers': '克里夫蘭騎士',
      'Dallas Mavericks': '達拉斯小牛',
      'Denver Nuggets': '丹佛金塊',
      'Detroit Pistons': '底特律活塞',
      'Golden State Warriors': '金州勇士',
      'Houston Rockets': '休斯頓火箭',
      'Indiana Pacers': '印第安納溜馬',
      'LA Clippers': '洛杉磯快艇',
      'Los Angeles Lakers': '洛杉磯湖人',
      'Memphis Grizzlies': '曼菲斯灰熊',
      'Miami Heat': '邁阿密熱火',
      'Milwaukee Bucks': '密爾瓦基公鹿',
      'Minnesota Timberwolves': '明尼蘇達灰狼',
      'New Orleans Pelicans': '紐奧良鵜鶘',
      'New York Knicks': '紐約尼克',
      'Oklahoma City Thunder': '奧克拉荷馬雷霆',
      'Orlando Magic': '奧蘭多魔術',
      'Philadelphia 76ers': '費城76人',
      'Phoenix Suns': '菲尼克斯太陽',
      'Portland Trail Blazers': '波特蘭拓荒者',
      'Sacramento Kings': '沙加緬度國王',
      'San Antonio Spurs': '聖安東尼奧馬刺',
      'Toronto Raptors': '多倫多暴龍',
      'Utah Jazz': '猶他爵士',
      'Washington Wizards': '華盛頓巫師'
    };

    // 載入NBA球員資料
    async function loadNBAData() {
      try {
        // 模擬從NBA API獲取資料（實際上我們使用一個更完整的球員資料庫）
        const response = await fetch('https://api.balldontlie.io/v1/players?per_page=100');
        const data = await response.json();
        
        // 由於API限制，我們先用一個擴展的資料集
        allPlayers = [
          { id: 1, first_name: 'LeBron', last_name: 'James', teams: ['Cleveland Cavaliers', 'Miami Heat', 'Los Angeles Lakers'] },
          { id: 2, first_name: 'Stephen', last_name: 'Curry', teams: ['Golden State Warriors'] },
          { id: 3, first_name: 'Kevin', last_name: 'Durant', teams: ['Oklahoma City Thunder', 'Golden State Warriors', 'Brooklyn Nets', 'Phoenix Suns'] },
          { id: 4, first_name: 'Giannis', last_name: 'Antetokounmpo', teams: ['Milwaukee Bucks'] },
          { id: 5, first_name: 'Luka', last_name: 'Doncic', teams: ['Dallas Mavericks'] },
          { id: 6, first_name: 'Ja', last_name: 'Morant', teams: ['Memphis Grizzlies'] },
          { id: 7, first_name: 'James', last_name: 'Harden', teams: ['Oklahoma City Thunder', 'Houston Rockets', 'Brooklyn Nets', 'Philadelphia 76ers', 'LA Clippers'] },
          { id: 8, first_name: 'Kawhi', last_name: 'Leonard', teams: ['San Antonio Spurs', 'Toronto Raptors', 'LA Clippers'] },
          { id: 9, first_name: 'Paul', last_name: 'George', teams: ['Indiana Pacers', 'Oklahoma City Thunder', 'LA Clippers', 'Philadelphia 76ers'] },
          { id: 10, first_name: 'Damian', last_name: 'Lillard', teams: ['Portland Trail Blazers', 'Milwaukee Bucks'] },
          { id: 11, first_name: 'Anthony', last_name: 'Davis', teams: ['New Orleans Pelicans', 'Los Angeles Lakers'] },
          { id: 12, first_name: 'Kyrie', last_name: 'Irving', teams: ['Cleveland Cavaliers', 'Boston Celtics', 'Brooklyn Nets', 'Dallas Mavericks'] },
          { id: 13, first_name: 'Joel', last_name: 'Embiid', teams: ['Philadelphia 76ers'] },
          { id: 14, first_name: 'Nikola', last_name: 'Jokic', teams: ['Denver Nuggets'] },
          { id: 15, first_name: 'Jayson', last_name: 'Tatum', teams: ['Boston Celtics'] },
          { id: 16, first_name: 'Jimmy', last_name: 'Butler', teams: ['Chicago Bulls', 'Minnesota Timberwolves', 'Philadelphia 76ers', 'Miami Heat'] },
          { id: 17, first_name: 'Russell', last_name: 'Westbrook', teams: ['Oklahoma City Thunder', 'Houston Rockets', 'Washington Wizards', 'Los Angeles Lakers', 'LA Clippers'] },
          { id: 18, first_name: 'Chris', last_name: 'Paul', teams: ['New Orleans Pelicans', 'LA Clippers', 'Houston Rockets', 'Oklahoma City Thunder', 'Phoenix Suns', 'Golden State Warriors'] },
          { id: 19, first_name: 'Klay', last_name: 'Thompson', teams: ['Golden State Warriors'] },
          { id: 20, first_name: 'Draymond', last_name: 'Green', teams: ['Golden State Warriors'] },
          { id: 21, first_name: 'Donovan', last_name: 'Mitchell', teams: ['Utah Jazz', 'Cleveland Cavaliers'] },
          { id: 22, first_name: 'Trae', last_name: 'Young', teams: ['Atlanta Hawks'] },
          { id: 23, first_name: 'Zion', last_name: 'Williamson', teams: ['New Orleans Pelicans'] },
          { id: 24, first_name: 'Devin', last_name: 'Booker', teams: ['Phoenix Suns'] },
          { id: 25, first_name: 'Bradley', last_name: 'Beal', teams: ['Washington Wizards', 'Phoenix Suns'] },
          { id: 26, first_name: 'Karl-Anthony', last_name: 'Towns', teams: ['Minnesota Timberwolves', 'New York Knicks'] },
          { id: 27, first_name: 'Ben', last_name: 'Simmons', teams: ['Philadelphia 76ers', 'Brooklyn Nets'] },
          { id: 28, first_name: 'Jamal', last_name: 'Murray', teams: ['Denver Nuggets'] },
          { id: 29, first_name: 'De\'Aaron', last_name: 'Fox', teams: ['Sacramento Kings'] },
          { id: 30, first_name: 'Bam', last_name: 'Adebayo', teams: ['Miami Heat'] }
        ];
        
        document.getElementById('loading').style.display = 'none';
        document.getElementById('gameContent').style.display = 'block';
        newGame();
      } catch (error) {
        console.error('載入資料失敗:', error);
        document.getElementById('loading').textContent = '載入失敗，請重新整理頁面';
      }
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function newGame() {
      document.getElementById('result').textContent = '';
      document.getElementById('result').className = 'result';
      
      // 隨機選擇一個球員
      const randomIndex = Math.floor(Math.random() * allPlayers.length);
      currentPlayer = allPlayers[randomIndex];
      
      // 翻譯球隊名稱並打亂順序
      const translatedTeams = currentPlayer.teams.map(team => teamTranslations[team] || team);
      shuffle(translatedTeams);
      
      document.getElementById('teams').textContent = '這位球員曾效力於：' + translatedTeams.join('、');
      document.getElementById('guessInput').value = '';
      document.getElementById('guessInput').focus();
      hideAutocomplete();
    }

    function showAutocomplete(players) {
      const list = document.getElementById('autocompleteList');
      list.innerHTML = '';
      
      if (players.length === 0) {
        list.style.display = 'none';
        return;
      }
      
      players.forEach((player, index) => {
        const item = document.createElement('div');
        item.className = 'autocomplete-item';
        item.textContent = `${player.first_name} ${player.last_name}`;
        item.addEventListener('click', () => selectPlayer(player));
        list.appendChild(item);
      });
      
      list.style.display = 'block';
      selectedIndex = -1;
    }

    function hideAutocomplete() {
      document.getElementById('autocompleteList').style.display = 'none';
      selectedIndex = -1;
    }

    function selectPlayer(player) {
      document.getElementById('guessInput').value = `${player.first_name} ${player.last_name}`;
      hideAutocomplete();
    }

    function updateStats() {
      const total = correctCount + incorrectCount;
      const accuracy = total > 0 ? Math.round((correctCount / total) * 100) : 0;
      document.getElementById('stats').textContent = `正確: ${correctCount} | 錯誤: ${incorrectCount} | 準確率: ${accuracy}%`;
    }

    // 事件監聽器
    document.getElementById('guessInput').addEventListener('input', (e) => {
      const query = e.target.value.trim().toLowerCase();
      
      if (query.length < 2) {
        hideAutocomplete();
        return;
      }
      
      const matchingPlayers = allPlayers.filter(player => {
        const fullName = `${player.first_name} ${player.last_name}`.toLowerCase();
        return fullName.includes(query) || 
               player.first_name.toLowerCase().includes(query) || 
               player.last_name.toLowerCase().includes(query);
      }).slice(0, 10);
      
      showAutocomplete(matchingPlayers);
    });

    document.getElementById('guessInput').addEventListener('keydown', (e) => {
      const items = document.querySelectorAll('.autocomplete-item');
      
      if (e.key === 'ArrowDown') {
        e.preventDefault();
        selectedIndex = Math.min(selectedIndex + 1, items.length - 1);
        updateSelectedItem(items);
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        selectedIndex = Math.max(selectedIndex - 1, -1);
        updateSelectedItem(items);
      } else if (e.key === 'Enter') {
        if (selectedIndex >= 0 && items[selectedIndex]) {
          e.preventDefault();
          items[selectedIndex].click();
        } else {
          checkGuess();
        }
      } else if (e.key === 'Escape') {
        hideAutocomplete();
      }
    });

    function updateSelectedItem(items) {
      items.forEach((item, index) => {
        item.classList.toggle('selected', index === selectedIndex);
      });
    }

    document.addEventListener('click', (e) => {
      if (!e.target.closest('.input-container')) {
        hideAutocomplete();
      }
    });

    function checkGuess() {
      const guess = document.getElementById('guessInput').value.trim();
      if (!guess) return;
      
      const currentFullName = `${currentPlayer.first_name} ${currentPlayer.last_name}`;
      const isCorrect = guess.toLowerCase() === currentFullName.toLowerCase();
      
      const resultEl = document.getElementById('result');
      
      if (isCorrect) {
        correctCount++;
        resultEl.textContent = `🎉 恭喜你，答對了！正確答案是：${currentFullName}`;
        resultEl.className = 'result correct';
      } else {
        incorrectCount++;
        resultEl.textContent = `❌ 猜錯了！正確答案是：${currentFullName}`;
        resultEl.className = 'result incorrect';
      }
      
      updateStats();
      hideAutocomplete();
    }

    document.getElementById('submitBtn').addEventListener('click', checkGuess);
    document.getElementById('nextBtn').addEventListener('click', newGame);

    // 啟動遊戲
    loadNBAData();
  </script>
</body>
</html>
